# TapCode 预览器 - 项目概览

> 本文档为AI助手提供项目的全面概览，帮助快速理解项目结构、功能特性和技术实现。

## 项目定位

**TapCode 预览器**是一个专为移动端设计的Web应用，主要用于在手机上预览PC端开发的网站。采用现代化的透明浮动界面设计，提供沉浸式的预览体验。

- **项目名称**: TapCode 预览器 (tapcode-previewer)
- **版本**: 1.0.0
- **技术栈**: 纯HTML/CSS/JavaScript，无外部依赖
- **目标平台**: 移动端Web浏览器（特别优化iOS Safari）
- **设计风格**: iOS风格，透明浮动界面，毛玻璃效果

## 核心架构

### 文件结构
```
tapcode-previewer/
├── index.html          # 主页面，包含完整的应用结构
├── style.css           # 样式表（30KB+，1400+行）
├── script.js           # 主要逻辑（31KB+，900+行）
├── config.js           # 配置文件（功能开关、主题等）
├── package.json        # 项目信息和脚本
├── minigame_config.json # 小程序配置
├── qrcode.html         # 二维码生成页面
├── build.sh/.bat       # 构建脚本
├── start.sh/.bat       # 启动脚本
├── docs/               # 文档目录
│   ├── README.md       # 文档索引
│   ├── USAGE_GUIDE.md  # 使用指南
│   ├── NEW_FEATURES.md # 新功能说明
│   ├── CHANGELOG.md    # 更新日志
│   └── ...
└── taptap-asset/       # 静态资源
```

### 技术特点
- **无依赖**: 纯前端实现，不依赖任何外部库
- **响应式**: 完全适配各种屏幕尺寸和方向
- **模块化**: 功能模块化设计，易于维护和扩展
- **可配置**: 通过config.js统一管理功能开关和配置

## 主要功能模块

### 1. 核心预览功能
- **iframe嵌套**: 使用iframe加载目标网站
- **URL管理**: 支持通过URL参数指定预览地址
- **加载状态**: 进度条、超时处理、连接状态监控
- **全屏模式**: 沉浸式预览体验

### 2. 移动端优化
- **浮动工具栏**: 底部定位，适配手机圆角
- **手势支持**: 左右滑动菜单、上下滑动工具栏
- **触摸优化**: 按钮大小和间距适合手指操作
- **屏幕旋转**: 模拟设备旋转效果

### 3. 界面交互
- **侧边菜单**: 左滑打开，包含各种设置和功能
- **深色模式**: 支持系统深色模式和手动切换
- **状态指示**: 网络连接、加载进度等状态显示
- **按钮反馈**: 点击动画和视觉反馈

### 4. TapCode AI对话 🤖
- **智能交流**: 右下角对话按钮，与TapCode进行实时交流
- **上下文感知**: 自动收集控制台日志作为对话上下文
- **简洁界面**: 清爽的对话界面，专注于问题解决
- **问题反馈**: 支持详细描述问题并获得专业解答

### 5. Console日志系统 📊
- **日志拦截**: 自动拦截并收集console.log/error/warn/info
- **实时监控**: 支持最多50条日志的缓存
- **可视化查看**: 专门的日志查看器，支持时间戳和类型分类
- **智能集成**: 日志自动作为AI对话的上下文信息

### 6. 滚动行为控制
- **精确控制**: 完全阻止iframe内容的滚动行为
- **iOS兼容**: 特别针对iOS Safari的滚动问题进行修复
- **多层防护**: HTML属性 + CSS样式 + JavaScript事件监听

## 用户界面设计

### 界面布局
```
┌─────────────────────────────────────┐
│ Status Bar (状态栏)                 │ ← 网络状态、时间等
├─────────────────────────────────────┤
│                                     │
│                                     │
│        Preview Content              │ ← iframe预览内容
│         (预览内容)                  │
│                                     │
│                                     │
├─────────────────────────────────────┤
│ Floating Toolbar (浮动工具栏)       │ ← 底部工具栏
└─────────────────────────────────────┘
```

### 设计原则
- **透明浮动**: 工具栏悬浮在内容上方，背景透明毛玻璃效果
- **iOS风格**: 采用Apple设计语言，圆角、阴影、间距
- **极简主义**: 界面元素精简，突出预览内容
- **无障碍**: 支持键盘导航和屏幕阅读器

## 配置系统

### CONFIG.js 主要配置项
```javascript
{
    DEFAULT_PREVIEW_URL: '默认预览地址',
    LOAD_TIMEOUT: 15000,           // 加载超时
    TOAST_DURATION: 3000,          // 提示显示时间
    THEME: { /* 主题色彩配置 */ },
    FEATURES: {
        showLoadingAnimation: true,  // 功能开关
        enableKeyboardShortcuts: true,
        enableTouchGestures: true,
        // ... 更多功能开关
    }
}
```

## 开发和部署

### 本地开发
```bash
# 启动开发服务器
./start.sh     # Linux/Mac
start.bat      # Windows
```

### 构建发布
```bash
# 构建生产版本
./build.sh     # Linux/Mac
build.bat      # Windows
```

### 项目脚本
- `package.json` 定义了基本的构建脚本
- 支持跨平台的shell脚本和bat脚本
- 构建产物输出到 `dist/` 目录

## 最近的重要更新

### 工具栏重新定位 (Latest)
- **变更**: 工具栏从顶部移动到底部
- **原因**: 适配手机屏幕圆角，提升用户体验
- **影响**: 所有屏幕尺寸的响应式适配调整

### 滚动行为优化
- **问题**: iOS Safari中iframe内容意外可滚动
- **解决**: 多层滚动阻止策略（HTML + CSS + JS）
- **效果**: 完全匹配iOS Safari的原生滚动行为

### Console日志系统
- **新增**: 完整的控制台日志收集和查看功能
- **特性**: 实时收集、分类显示、AI上下文集成
- **位置**: 侧边菜单中的"Console Logs"选项

### UI简化优化
- **改进**: 简化对话框信息显示
- **调整**: 降低突出元素的视觉重量
- **效果**: 更加简洁和专业的界面

## 技术细节

### 响应式断点
```css
/* 手机竖屏 */
@media (max-width: 480px) { ... }

/* 手机横屏/小平板 */
@media (min-width: 481px) and (max-width: 768px) { ... }

/* 平板 */
@media (min-width: 769px) and (max-width: 1024px) { ... }
```

### JavaScript 模块组织
- DOM元素获取和事件绑定
- 状态管理 (isFullscreen, isMenuOpen等)
- Console日志收集系统
- 手势识别和处理
- TapCode对话功能
- 深色模式控制

### CSS 架构
- CSS自定义属性（CSS变量）用于主题切换
- Flexbox和Grid布局用于响应式设计
- 动画和过渡效果优化
- iOS Safari兼容性处理

## 用户使用场景

1. **移动端调试**: 开发者在手机上预览PC端网站
2. **客户演示**: 向客户展示网站的移动端效果
3. **跨设备测试**: 测试响应式设计在不同设备上的表现
4. **问题排查**: 结合Console日志和AI对话快速定位问题

## 维护注意事项

### 代码风格
- 使用现代JavaScript (ES6+)
- CSS使用BEM命名规范的变体
- 注释详细，特别是复杂的功能模块

### 兼容性
- 主要目标: iOS Safari 12+
- 次要目标: Android Chrome 70+
- 特别注意iOS Safari的滚动和touch事件处理

### 性能考虑
- 避免大量DOM操作
- 使用CSS transform进行动画
- Console日志限制在50条以内
- iframe加载超时控制

---

> 📝 **使用建议**: 新的AI会话应该首先阅读本文档，然后根据用户的具体需求查看相关的详细文档（如USAGE_GUIDE.md、NEW_FEATURES.md等）。对于代码修改，建议先查看最新的git提交历史了解最近的变更。 